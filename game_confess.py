import db_manager

def register_confess_handlers(bot):

    # --- ุจุฏุงูุฉ ููุฏ ุงููุชุฌุฑ ---
    @bot.message_handler(func=lambda m: m.text in ["ูุชุฌุฑ", "ุงููุชุฌุฑ"])
    def send_shop(m):
        shop_text = (
            "โ๏ธูุงุฆูุฉ ูุชุฌุฑ ุงูุฅูุจุฑุงุทูุฑูุฉ\n"
            "โโโโโโโโโโโโโ\n"
            "โ๏ธุดุฑุงุก ุฏุฑุน ยป 3000\n"
            "โ๏ธุดุฑุงุก ุนูู ยป 5000\n"
            "โ๏ธุดุฑุงุก ูููุฉ ยป 1000\n"
            "โ๏ธุดุฑุงุก ูุถุงุนูุฉ ยป 10,000\n"
            "โ๏ธุดุฑุงุก ุตูุฏูู ุงูุญุธ ยป 1000\n"
            "โ๏ธุดุฑุงุก ุงูููุฒ ยป 1000\n"
            "โ๏ธุฅุฑุณุงู ุนูุฏูุฉ ยป 200\n"
            "โ๏ธุงูุฑุณุงูุฉ ุงููุซุจุชู ยป 100\n"
            "โ๏ธุดุฑุงุก ุฑูุน ูุณุชูู ยป 500\n"
            "โ๏ธุจุงูู ุตุฏูู ยป 1000\n"
            "โโโโโโโโโโโโโ\n"
            "๐ก ุงูุชุจ [ ุดุฑุงุก + ุงุณู ุงูุบุฑุถ ]"
        )
        bot.reply_to(m, shop_text)

    @bot.message_handler(func=lambda m: m.text and m.text.startswith("ุดุฑุงุก "))
    def process_buy(m):
        user_id = str(m.from_user.id)
        command = m.text.replace("ุดุฑุงุก ", "").strip()
        
        # ูุงุฆูุฉ ุงูุฃุณุนุงุฑ [cite: 2026-01-02]
        prices = {
            "ุฏุฑุน": 3000, "ุนูู": 5000, "ูููุฉ": 1000, 
            "ูุถุงุนูุฉ": 10000, "ุตูุฏูู ุงูุญุธ": 1000, "ุงูููุฒ": 1000, 
            "ุนูุฏูุฉ": 200, "ุฑุณุงูุฉ ูุซุจุชุฉ": 100, "ุจุงูู ุตุฏูู": 1000
        }

        if command in prices:
            price = prices[command]
            # ุงุณุชุฎุฏุงู ุงูุฏูุงู ุงูุชู ุฃุถูุชูุง ุฃูุช ูู db_manager
            money = db_manager.get_balance(user_id)
            
            if money >= price:
                db_manager.update_balance(user_id, -price)
                bot.reply_to(m, f"โ ุชู ุดุฑุงุก {command} ุจูุฌุงุญ!\n๐ฐ ุงููุชุจูู: {money - price}")
            else:
                bot.reply_to(m, f"โ ุฑุตูุฏู ({money}) ูุง ูููู!")
        
        elif command.startswith("ุฑูุน ูุณุชูู"):
            money = db_manager.get_balance(user_id)
            if money >= 500:
                db_manager.update_balance(user_id, -500)
                db_manager.update_level(user_id, 10)
                bot.reply_to(m, "๐ ุชู ุฑูุน ูุณุชูุงู 10 ูุณุชููุงุช ุจูุฌุงุญ!")
            else:
                bot.reply_to(m, "โ ุฑุตูุฏู ูุง ูููู (ุงูุณุนุฑ: 500).")
    # --- ููุงูุฉ ููุฏ ุงููุชุฌุฑ ---

    # ููุง ููููู ุฅุถุงูุฉ ููุฏ ุงูุงุนุชุฑุงูุงุช ุงูุฎุงุต ุจู ุจููุณ ูุณุชูู ุงููุณุงูุงุช (4 ูุณุงูุงุช)
import random
from telebot import types

def register_handlers(bot):
    
    # ูุงุฆูุฉ ุงูู 50 ุณุคุงูุงู ุงูุฅูุจุฑุงุทูุฑูุฉ
    CONFESS_QUESTIONS = [
        "ูู ุชุซู ุจููุณู ูุนููุงุ", "ูู ุชุฎุงู ูู ููุฏุงู ุดุฎุต ููุฑูุจุ", "ูู ูุฏูุช ููููุง ุนูู ูุฑุงุฑ ูููุ",
        "ูู ุชุญุจ ุงูุนุฒูุฉ ุฃุญูุงููุงุ", "ูู ุชููู โุฃูุง ุจุฎูุฑโ ูุฃูุช ูุณุช ูุฐููุ", "ูู ุณุงูุญุช ุดุฎุตูุง ูุง ูุณุชุญูุ",
        "ูู ุชุดุชุงู ูุดุฎุต ูุง ุชุชุญุฏุซ ูุนูุ", "ูู ุชุญุณ ุฃูู ูุฎุชูู ุนู ูุญูุทูุ", "ูู ูุชูุช ูุดุงุนุฑู ุญุชู ุชุนุจุชุ",
        "ูู ุชุฎุงู ูู ุงููุณุชูุจูุ", "ูู ูุฑู ุนููู ููู ุชููููุช ูู ูุฎุชููุ", "ูู ุชุซู ุจุงููุงุณ ุจุณุฑุนุฉุ",
        "ูู ุชุญุจ ุงูุงูุชูุงู ุญุชู ูู ุฃููุฑุชุ", "ูู ุชุชุธุงูุฑ ุจุงูููุฉ ุฃูุงู ุงูุขุฎุฑููุ", "ูู ุชุดุนุฑ ุฃูู ูุธููู ุฃุญูุงููุงุ",
        "ูู ูุง ุฒุงู ุงููุงุถู ูุคูููุ", "ูู ุชุฎุงู ุฃู ุชูุฎุฐู ูุฑุฉ ุฃุฎุฑูุ", "ูู ุชุญุจ ุดุฎุตูุง ููุง ูุณุชุทูุน ุฃู ูุนุฑูุ",
        "ูู ุชูุฑู ุงููุฏุงุนุ", "ูู ุชุฎุงู ูู ุงููุญุฏุฉุ", "ูู ุชุถุน ุงูุขุฎุฑูู ูุจู ููุณู ุบุงูุจูุงุ",
        "ูู ุชุญุณ ุฃูู ุบูุฑ ูููููุ", "ูู ุชุฎูู ุฏููุนู ุนู ุงูุฌููุนุ", "ูู ุชุฎุงู ุฃู ุชุฎุณุฑ ููุณูุ",
        "ูู ุชุญุจ ุงูุตูุช ุฃูุซุฑ ูู ุงูููุงูุ", "ูู ุชุดุนุฑ ุฃูู ุฃูุจุฑ ูู ุนูุฑูุ", "ูู ุณุงูุญุช ููุณู ูุนููุงุ",
        "ูู ุชุญุณ ุฃูู ุชุญุชุงุฌ ุจุฏุงูุฉ ุฌุฏูุฏุฉุ", "ูู ุชุฎุงู ูู ุงูุงุฑุชุจุงุทุ", "ูู ุฌุฑุญุช ุดุฎุตูุง ุชุญุจู ุฏูู ูุตุฏุ",
        "ูู ุชุญุจ ุฃู ุชููู ูุญุฏู ููู ุชูุฑู ุงูุดุนูุฑ ุจุงููุญุฏุฉุ", "ูู ุชุซู ุจุดุฎุต ูุงุญุฏ ููุท ูู ุญูุงุชูุ",
        "ูู ุชุดุนุฑ ุฃูู ุชุนุทู ุฃูุซุฑ ููุง ุชุฃุฎุฐุ", "ูู ุชุฎุงู ูู ุฃู ุชููู ููุณููุงุ", "ูู ุชุดุนุฑ ุฃู ููุจู ูุชุนุจุ",
        "ูู ุชุญุจ ุงูููู ุฃูุซุฑ ูู ุงูููุงุฑุ", "ูู ุชุคูู ุฃู ูู ุดูุก ูุญุฏุซ ูุณุจุจุ", "ูู ุญุงููุช ุฃู ุชุชุบูุฑ ูู ุฃุฌู ุดุฎุตุ",
        "ูู ุชูุชูุฏ ูุณุฎุฉ ูุฏููุฉ ูู ููุณูุ", "ูู ุชุดุนุฑ ุฃูู ููู ุฑุบู ูู ุดูุกุ", "ูู ุชุฎุงู ูู ุฃู ุชูููู ุฎุทุฃุ",
        "ูู ุชุญุชุงุฌ ูู ูุณูุนู ููุทุ", "ูู ูุฑุฑุช ุจุชุฌุฑุจุฉ ุบููุฑุชู ููุฃุจุฏุ", "ูู ุชุดุนุฑ ุฃูู ุชุณุชุญู ุงูุฃูุถูุ",
        "ูู ุชุญุจ ูู ููุชู ุจุงูุชูุงุตูู ุงูุตุบูุฑุฉุ", "ูู ุชุฎุงู ูู ููู ุงูุญูููุฉ ุฃุญูุงููุงุ", "ูู ุชุดุนุฑ ุฃู ููุจู ุทูุจ ุฃูุซุฑ ููุง ูุฌุจุ",
        "ูู ุชุญุณ ุฃูู ุดุฎุต ุนูููุ", "ูู ุชุคูู ุฃู ุงูุตูุช ุฃุญูุงููุง ุฌูุงุจุ", "ูู ูุง ุฒูุช ุชุญุงูู ุฑุบู ุงูุชุนุจุ"
    ]

    @bot.message_handler(func=lambda m: m.text == "ุงุนุชุฑุงู")
    def start_confess(m):
        # ุงุฎุชูุงุฑ ุณุคุงู ุนุดูุงุฆู ูู ูู ูุฑุฉ
        question = random.choice(CONFESS_QUESTIONS)
        
        # ุชุตููู ูููู ูููุจ ุจุฏูู ุฃุฒุฑุงุฑ
        text = (
            "โโโโโโโโ โ โโโโโโโโ\n"
            "         โฏ ููุฑุณูู ุงูุงุนูุชูุฑุงู โฏ\n"
            "โโโโโโโโ โ โโโโโโโโ\n\n"
            f"๐ค ุฅููู : {m.from_user.first_name}\n\n"
            f"๐ฌ ุงููุณูุคุงู :\n"
            f"ยซ **{question}** ยป\n\n"
            "โ๏ธ ุฃุฌูุจ ุจูููู ุตูุฑุงุญุฉ.."
        )
        
   bot.send_message(m.chat.id, text, parse_mode="Markdown")
