import random

def register_handlers(bot):
    # ูุงุฆูุฉ ุงูู 70 ุชุญุฏู (ุงูุฑุงุจุท : ุงูุฅุฌุงุจุฉ)
    # ููุงุญุธุฉ: ุงุณุชุฎุฏูุช ุฑูุงุจุท CDN ูุตูุฑ ุฅูููุฌูุงุช ุฃุจู ุงููุฎูุฉ
    EMOJI_DATA = {
        "https://emojicdn.elk.sh/๐?style=apple": "ุชูุงุญุฉ",
        "https://emojicdn.elk.sh/๐ฆ?style=apple": "ุฃุณุฏ",
        "https://emojicdn.elk.sh/๐?style=apple": "ุณูุงุฑุฉ",
        "https://emojicdn.elk.sh/๐?style=apple": "ุจูุชุฒุง",
        "https://emojicdn.elk.sh/โฝ?style=apple": "ูุฑุฉ ูุฏู",
        "https://emojicdn.elk.sh/๐ฆ?style=apple": "ุขูุณ ูุฑูู",
        "https://emojicdn.elk.sh/๐?style=apple": "ุตุงุฑูุฎ",
        "https://emojicdn.elk.sh/๐?style=apple": "ุงููุงุณ",
        "https://emojicdn.elk.sh/๐ผ?style=apple": "ุจุงูุฏุง",
        "https://emojicdn.elk.sh/๐?style=apple": "ูููุจ ุงูุงุฑุถ",
        # ... (ุชุณุชุทูุน ุชูุฑุงุฑ ุงูููุท ูู 70 ุฅูููุฌู ุจุณูููุฉ)
    }
    
    # ูุฅุถุงูุฉ ุงูู 70 ูุงููุฉุ ุณูููู ุจุฅูุดุงุก ูุงุฆูุฉ ุจุงูุฃุณูุงุก ุงูุดุงุฆุนุฉ ุจุฑูุฌูุงู ูุชูููุฑ ุงููุณุงุญุฉ
    common_emojis = {
        "๐": "ูุฑุงููุฉ", "๐": "ููุฒ", "๐": "ุนูุจ", "๐ฅฅ": "ุฌูุฒ ููุฏ", "๐ฅ": "ุงูููุงุฏู",
        "๐ฅ": "ุฌุฒุฑ", "๐ฝ": "ุฐุฑุฉ", "๐": "ุจุทุงุทุณ", "๐": "ููุจุฑุบุฑ", "๐ฃ": "ุณูุดู",
        "๐ฎ": "ุงูุนุงุจ", "๐ธ": "ุฌูุชุงุฑ", "๐": "ูุชุงุจ", "๐ฐ": "ูููุณ", "๐": "ููุชุงุญ",
        "๐": "ุฌุฑุณ", "๐": "ูุฏูุฉ", "๐": "ุจุงููู", "๐": "ุชุงุฌ", "โ": "ุณุงุนุฉ",
        "๐ฑ": "ูุงุชู", "๐ป": "ููุจููุชุฑ", "๐ท": "ูุงููุฑุง", "๐ค": "ูุงูู", "๐ง": "ุณูุงุนุฉ",
        "๐ฏ๏ธ": "ุดูุนุฉ", "๐ก๏ธ": "ุฏุฑุน", "โ๏ธ": "ุณูู", "๐น": "ููุณ", "โ": "ูุฑุณุงุฉ",
        "๐": "ูููููุจุชุฑ", "๐": "ูุทุงุฑ", "๐ณ๏ธ": "ุณูููุฉ", "๐ฒ": "ุฏุฑุงุฌุฉ", "๐ฆ": "ุงุดุงุฑุฉ ูุฑูุฑ",
        "๐": "ููุณ ูุฒุญ", "๐ฅ": "ูุงุฑ", "โ๏ธ": "ุซูุฌ", "โก": "ุจุฑู", "โ": "ูุทุฑ",
        "๐": "ููู", "๐ฆ": "ุญูุงุฑ ูุญุดู", "๐ฆ": "ุฒุฑุงูุฉ", "๐ช": "ุฌูู", "๐ฆ": "ูุฑุงุดุฉ",
        "๐ฆ": "ุณูุทุนูู", "๐": "ูุญูุฉ", "๐ฆ": "ุจููุฉ", "๐": "ุงุฎุทุจูุท", "๐ณ": "ุญูุช"
    }

    # ุฏูุฌ ูุชุฌููุฒ ุงูุฑูุงุจุท
    for emo, name in common_emojis.items():
        url = f"https://emojicdn.elk.sh/{emo}?style=apple"
        EMOJI_DATA[url] = name

    active_emoji_games = {}

    @bot.message_handler(func=lambda m: m.text == "ุงูููุฌู")
    def start_emoji_game(m):
        chat_id = m.chat.id
        img_url, answer = random.choice(list(EMOJI_DATA.items()))
        
        active_emoji_games[chat_id] = {"answer": answer}

        caption = (
            "โชโช๏ธูุง ุงุณู ุงูุงูููุฌู ูุฐุงุง ุ\n"
            "โโโโโโโโโโโโโ\n"
            "๐ก ุฃุฑุณู ุงุณู ุงูุงูููุฌู ุจุงููุบุฉ ุงูุนุฑุจูุฉ"
        )
        
        try:
            bot.send_photo(chat_id, img_url, caption=caption)
        except:
            bot.send_message(chat_id, f"๐ฎ ุงูุชุญุฏู ูู: {answer[0]}... (ุฎุทุฃ ูู ุชุญููู ุงูุตูุฑุฉ)")

    @bot.message_handler(func=lambda m: m.chat.id in active_emoji_games)
    def check_emoji(m):
        chat_id = m.chat.id
        correct = active_emoji_games[chat_id]["answer"]
        
        if m.text.strip() == correct:
            bot.reply_to(m, f"โ ููู ูุง ุจุทู! ุงูุฅุฌุงุจุฉ: {correct}\n๐ฐ +50 ููุทุฉ.")
            del active_emoji_games[chat_id]
