import random
import db_manager

def register_handlers(bot):

    @bot.message_handler(func=lambda m: m.text == "ูุจุถ")
    def pulse_game(m):
        # ุงูุญุงุฑุณ ุงูุฅูุจุฑุงุทูุฑู (ุชุฌุงูู ุงููุญุธูุฑูู)
        if db_manager.get_user(m.from_user.id).get("banned"):
            return

        # ููุงุฆู ุงููุชุนุฉ (ููููู ุฒูุงุฏุชูุง ููุง ุชุดุงุก ูุง ูููุงู)
        psychological_states = [
            "ูุณุชูุฑ ููุงุฏุฆ ูุงูุจุญุฑ", "ูุชูุชุฑ ููููุงู", "ุณุนูุฏ ุฌุฏุงู", 
            "ุนุงุดู ูููุงู", "ูุฑูู ููุญุชุงุฌ ููููู", "ูุชุญูุณ ูููุบุงูุฑุฉ", 
            "ูู ููุฉ ุงูุฑูุงู", "ูุดุชุงู ูุฃุญุฏูู", "ููุชู ููุญูุงุฉ"
        ]

        advices = [
            "ุชุญุฏุซ ุฃููุ ุงุณุชูุน ุฃูุซุฑ.",
            "ุงุจุชุณูุ ูุฌูุงู ูุฌูู ูุง ูููู ุจู ุงูุนุจูุณ.",
            "ูุง ุชุฃุฎุฐ ุงูุฃููุฑ ุนูู ูุญูู ุงูุดุฎุตูุฉ ุฏุงุฆูุงู.",
            "ุฎุฐ ููุณุงู ุนูููุงูุ ูู ุดูุก ุณูููู ุจุฎูุฑ.",
            "ุงุนุชุฒู ูุง ูุคุฐููุ ููู ูุงู ุบุงููุงู.",
            "ุงุฌุนู ูููู ูููุฆุงู ุจุงููุทูุ ูุณูุนูุฏ ุฅููู.",
            "ุงููููู ูู ุงููุฏูุก ูุญู ุงููุซูุฑ ูู ุงูุนูุฏ.",
            "ุจุงุฏุฑ ุจุงูุณูุงูุ ููููุฉ ุทูุจุฉ ุชูุชุญ ูุบุงููู ุงููููุจ."
        ]

        # ุงุฎุชูุงุฑ ุงูููู ุนุดูุงุฆูุงู
        pulse_rate = random.randint(60, 100)
        state = random.choice(psychological_states)
        advice = random.choice(advices)
        user_name = m.from_user.first_name

        # ุตูุงุบุฉ ุงูุฑุฏ
        response = (
            f"โค๏ธ **ููุจูุถ {user_name}:** {pulse_rate}/100\n"
            f"๐ง **ุงููุญูุงููุฉ ุงููููููุณูููุฉ:** {state}\n"
            f"๐ฟ **ููุตูููุญูุฉ ููููุญูููุงุฉ:** {advice}"
        )

        bot.reply_to(m, response)
